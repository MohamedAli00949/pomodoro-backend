"use strict";(self.webpackChunkpomodoro_=self.webpackChunkpomodoro_||[]).push([[845],{3845:function(e,o,n){n.r(o),n.d(o,{default:function(){return h}});var t=n(885),i=n(2791),l=n(9434),a=n(601),r=n(7710),c=n(771),u=n(6409),d=n(7425),s=n(5880),m=n(184);var f=function(){var e=(0,i.useState)("popup"===localStorage.getItem("opened")),o=(0,t.Z)(e,2),n=o[0],l=o[1],a=function(e){var o,n;"open"in window&&((null===window.opener||null!==(o=window)&&void 0!==o&&null!==(n=o.opener)&&void 0!==n&&n.closed)&&window.open("/","popup","left=100,top=100,height=332,width=356"))};if(window.onmessage=function(e){window.origin===e.origin&&("opened"===e.data?(console.log(e.source.name),console.log(e.data),console.log(e.data),l(!0)):"close"===e.data&&(localStorage.removeItem("opened"),l(!1)))},(0,i.useEffect)((function(){window.onkeydown=function(e){"keye"===e.code.toLowerCase()&&a()}})),"open"in window!==!1)return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("button",{"aria-label":"small external window",className:"timer-button",type:"button",onClick:a,children:n?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(s.vkH,{})}):(0,m.jsx)(d.uXP,{})})})},v=n(8820);var p=function(e){var o=e.setOpenSetting;return(0,m.jsx)("button",{"aria-label":"small external window",className:"timer-button setting-open",type:"button",onClick:function(){return o(!0)},children:(0,m.jsx)(v.zPD,{})})},g=function(){var e=(0,i.useState)(!1),o=(0,t.Z)(e,2),n=o[0],l=o[1],a=(0,i.useCallback)((function(){l((function(e){return!e})),n?document.exitFullscreen():document.documentElement.requestFullscreen()}),[n]);return(0,i.useEffect)((function(){window.onkeydown=function(e){"keyf"===e.code.toLowerCase()&&a()}})),(0,m.jsx)("button",{"aria-label":"full screen",className:"timer-button",type:"button",onClick:a,style:{left:"65px"},children:n?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(d.G0_,{})}):(0,m.jsx)(d.xuP,{})})},w=(0,i.lazy)((function(){return n.e(178).then(n.bind(n,2178))})),k=(0,i.lazy)((function(){return Promise.all([n.e(578),n.e(23)]).then(n.bind(n,9023))})),y=new window.Worker("worker.js"),h=function(e){var o,n,d,s,v,h=e.setIsLoadingTask,b=e.setMessage,x=e.setOpenSetting,T=(0,l.v9)((function(e){return e.timer})),j=T.active,S=T.activites,I=T.setting,N=T.started,P=T.periodNum,C=(0,l.v9)((function(e){return e.tasks})).activeId,F=(0,i.useState)(null===localStorage.getItem("restOfTime")?0:Number(localStorage.getItem("restOfTime"))),E=(0,t.Z)(F,2),O=E[0],R=E[1],V=null===I||void 0===I?void 0:I.time[j],L=(0,l.I0)(),B=(0,i.useRef)("none"!==(null===I||void 0===I||null===(o=I.tickingType)||void 0===o?void 0:o.name)?(0,c.Z)({src:null===I||void 0===I||null===(n=I.tickingType)||void 0===n?void 0:n.src,volume:null===I||void 0===I?void 0:I.tickingVolume,loop:!0}):null),M=(0,i.useRef)((0,c.Z)({src:null===I||void 0===I||null===(d=I.alarmType)||void 0===d?void 0:d.src,volume:null===I||void 0===I?void 0:I.alarmVolume,loop:I.alarmRepet>0})),Z=(0,i.useRef)("none"!==(null===I||void 0===I||null===(s=I.clickType)||void 0===s?void 0:s.name)?(0,c.Z)({src:null===I||void 0===I||null===(v=I.clickType)||void 0===v?void 0:v.src,volume:null===I||void 0===I?void 0:I.clickVolume}):null);(0,i.useEffect)((function(){var e,o,n,t;"Notification"in window&&("default"===(null===(e=window)||void 0===e||null===(o=e.Notification)||void 0===o?void 0:o.permission)&&(null===(n=window)||void 0===n||null===(t=n.Notification)||void 0===t||t.requestPermission()))}),[]),(0,i.useEffect)((function(){document.body.style.backgroundColor=S[j].color,void 0!==I.time&&((null===I||void 0===I?void 0:I.time[j])-Number(localStorage.getItem("restOfTime"))>1?R((null===I||void 0===I?void 0:I.time[j])-Number(localStorage.getItem("restOfTime"))):(L((0,a.P8)(j,C,h,b)),localStorage.setItem("restOfTime",0)))}),[j,I.time]),(0,i.useEffect)((function(){"none"!==(null===I||void 0===I?void 0:I.tickingType.name)&&(B.current.chengeVolume(null===I||void 0===I?void 0:I.tickingVolume),B.current.changeFile(null===I||void 0===I?void 0:I.tickingType.src)),M.current.chengeVolume(null===I||void 0===I?void 0:I.alarmVolume),M.current.changeFile(null===I||void 0===I?void 0:I.alarmType.src),M.current.changeLoop(null===I||void 0===I?void 0:I.alarmRepet),"none"!==I.clickType.name&&(Z.current.chengeVolume(I.clickVolume),Z.current.changeFile(I.clickType.src))}),[I]),(0,i.useEffect)((function(){(j===a.aI&&I.autoPomodors||j!==a.aI&&I.autoBreaks)&&0!==P&&N&&(setTimeout((function(){M.current.handleStop(),"none"!==I.tickingType.name&&B.current.handlePlay(),y.postMessage({started:!N,count:I.time[j]}),L({type:a.BG,data:0}),console.log(O,0,"autoBreaks autoPomodors")}),5e3),console.log(j))}),[j,I.autoBreaks,I.autoPomodors]),(0,i.useEffect)((function(){N?(document.body.onbeforeunload=function(){return function(){return"Hello, world!"}},I.focusMode&&(document.body.style.backgroundColor="rgb(30 30 30)",document.body.style.overflow="hidden")):(document.body.onbeforeunload=null,I.focusMode&&(document.body.style.backgroundColor=S[j].color,document.body.style.overflow="auto"))}),[N]),y.onmessage=function(e){var o,n,t;"stop"!==e.data?(R(e.data),"Notification"in window&&"granted"===(null===(o=window)||void 0===o||null===(n=o.Notification)||void 0===n?void 0:n.permission)&&0!==O&&("every"===I.notificationType?O%(60*I.notificationInterval)===0&&O!==V&&(0,r.h)("".concat(O/60," minutes left!")):O-60*I.notificationInterval===0&&O!==V&&(0,r.h)("".concat(O/60," minutes left!")))):(console.log(e.data,O,0,"worker stop"),"none"!==I.tickingType.name&&B.current.handleStop(),M.current.handlePlay(),(j!==a.aI&&!I.autoPomodors||j===a.aI&&!I.autoBreaks)&&L({type:a.pt,data:0}),I.alarmRepet>0&&(M.current.changeLoop(!0),setTimeout((function(){M.current.handleStop()}),1e3*I.alarmRepet),console.log("alarm repet")),L((0,a.P8)(j,C,h,b)),"Notification"in window&&"granted"===(null===(t=window)||void 0===t?void 0:t.Notification.permission)&&(j===a.aI?(0,r.h)("It's time to take a break"):(0,r.h)("It's time to focus!")))};var z=function(e){"space"===e.code.toLowerCase()&&q(),"arrowright"!==e.code.toLowerCase()||N||_(),"keyc"!==e.code.toLowerCase()||N||G()};(0,i.useEffect)((function(){window.onkeydown=z}));var q=(0,i.useCallback)((function(){console.log("toggle start"),"none"!==I.clickType.name&&Z.current.handlePlay(),M.current.handleStop(),N?(y.postMessage("stop"),"none"!==I.tickingType.name&&B.current.handleStop(),L({type:a.pt,data:I.time[j]-O})):("none"!==I.tickingType.name&&B.current.handlePlay(),N||y.postMessage({started:!N,count:O}),L({type:a.BG,data:0}))}),[N,O]),G=function(){R(V),"none"!==I.clickType.name&&Z.current.handlePlay(),localStorage.setItem("restOfTime",0)},_=function(){L({type:a.vg})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"clock-container",style:{background:S[j].timerBorder},children:[!N&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(f,{}),(0,m.jsx)(p,{setOpenSetting:x}),(0,m.jsx)(g,{})]}),(0,m.jsx)("div",{className:"clock",children:(0,m.jsx)(i.Suspense,{fallback:(0,m.jsx)(u.Z,{color:S[j].color,backgroud:"transparent",size:"200",strokeWidth:"2.5"}),children:"digital"===I.format?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(k,{handleReset:G,toggleStart:q,setTime:R,time:O,handleSkip:_})}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(w,{handleReset:G,toggleStart:q,setTime:R,time:O,handleSkip:_})})})})]})})}},7710:function(e,o,n){n.d(o,{h:function(){return i},m:function(){return t}});var t=function(e){var o=e%60,n=Math.floor(e/60);return"".concat(n>=10?n:"0"+n,":").concat(o>=10?o:"0"+o)},i=function(e){var o;void 0!==typeof(null===(o=window)||void 0===o?void 0:o.Notification)&&new window.Notification(e,{icon:"favicon.ico",tag:"mohamed ali",requireInteraction:!0,renotify:!0})}}}]);
//# sourceMappingURL=845.630a7dc0.chunk.js.map