"use strict";(self.webpackChunkpomodoro_=self.webpackChunkpomodoro_||[]).push([[845],{3845:function(e,o,n){n.r(o),n.d(o,{default:function(){return k}});var t=n(885),i=n(2791),a=n(9434),l=n(601),r=n(7710),c=n(771),u=n(6409),d=n(7425),s=n(5880),m=n(184);var g=function(){var e=(0,i.useState)("popup"===localStorage.getItem("opened")),o=(0,t.Z)(e,2),n=o[0],a=o[1],l=function(e){var o,n;"open"in window&&((null===window.opener||null!==(o=window)&&void 0!==o&&null!==(n=o.opener)&&void 0!==n&&n.closed)&&window.open("/","popup","left=100,top=100,height=332,width=356"))};if(window.onmessage=function(e){window.origin===e.origin&&("opened"===e.data?(console.log(e.source.name),console.log(e.data),console.log(e.data),a(!0)):"close"===e.data&&(localStorage.removeItem("opened"),a(!1)))},(0,i.useEffect)((function(){window.onkeydown=function(e){"keye"===e.code.toLowerCase()&&l()}})),"open"in window!==!1)return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("button",{"aria-label":"small external window",className:"timer-button",type:"button",onClick:l,children:n?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(s.vkH,{})}):(0,m.jsx)(d.uXP,{})})})},f=n(8820);var v=function(e){var o=e.setOpenSetting;return(0,m.jsx)("button",{"aria-label":"small external window",className:"timer-button setting-open",type:"button",onClick:function(){return o(!0)},children:(0,m.jsx)(f.zPD,{})})},p=function(){var e=(0,i.useState)(!1),o=(0,t.Z)(e,2),n=o[0],a=o[1],l=(0,i.useCallback)((function(){a((function(e){return!e})),n?document.exitFullscreen():document.documentElement.requestFullscreen()}),[n]);return(0,i.useEffect)((function(){window.onkeydown=function(e){"keyf"===e.code.toLowerCase()&&l()}})),(0,m.jsx)("button",{"aria-label":"full screen",className:"timer-button",type:"button",onClick:l,style:{left:"65px"},children:n?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(d.G0_,{})}):(0,m.jsx)(d.xuP,{})})},w=(0,i.lazy)((function(){return n.e(178).then(n.bind(n,2178))})),y=(0,i.lazy)((function(){return Promise.all([n.e(578),n.e(23)]).then(n.bind(n,9023))})),h=new window.Worker("worker.js"),k=function(e){var o,n,d,s,f,k=e.setIsLoadingTask,b=e.setMessage,x=e.setOpenSetting,T=(0,a.v9)((function(e){return e.timer})),S=T.active,j=T.activites,I=T.setting,N=T.started,C=T.periodNum,P=(0,a.v9)((function(e){return e.tasks})).activeId,F=(0,i.useState)(null===localStorage.getItem("restOfTime")?0:Number(localStorage.getItem("restOfTime"))),M=(0,t.Z)(F,2),D=M[0],L=M[1],E=null===I||void 0===I?void 0:I.time[S],O=(0,a.I0)(),R=(0,i.useRef)("none"!==(null===I||void 0===I||null===(o=I.tickingType)||void 0===o?void 0:o.name)?(0,c.Z)({src:null===I||void 0===I||null===(n=I.tickingType)||void 0===n?void 0:n.src,volume:null===I||void 0===I?void 0:I.tickingVolume,loop:!0}):null),V=(0,i.useRef)((0,c.Z)({src:null===I||void 0===I||null===(d=I.alarmType)||void 0===d?void 0:d.src,volume:null===I||void 0===I?void 0:I.alarmVolume,loop:I.alarmRepet>0})),B=(0,i.useRef)("none"!==(null===I||void 0===I||null===(s=I.clickType)||void 0===s?void 0:s.name)?(0,c.Z)({src:null===I||void 0===I||null===(f=I.clickType)||void 0===f?void 0:f.src,volume:null===I||void 0===I?void 0:I.clickVolume}):null);(0,i.useEffect)((function(){var e,o,n,t;"Notification"in window&&("default"===(null===(e=window)||void 0===e||null===(o=e.Notification)||void 0===o?void 0:o.permission)&&(null===(n=window)||void 0===n||null===(t=n.Notification)||void 0===t||t.requestPermission()))}),[]),(0,i.useEffect)((function(){document.body.style.backgroundColor=j[S].color,void 0!==I.time&&((null===I||void 0===I?void 0:I.time[S])-Number(localStorage.getItem("restOfTime"))>1?L((null===I||void 0===I?void 0:I.time[S])-Number(localStorage.getItem("restOfTime"))):(O((0,l.P8)(S,P,k,b)),localStorage.setItem("restOfTime",0)))}),[S,I.time]),(0,i.useEffect)((function(){"none"!==(null===I||void 0===I?void 0:I.tickingType.name)&&(R.current.chengeVolume(null===I||void 0===I?void 0:I.tickingVolume),R.current.changeFile(null===I||void 0===I?void 0:I.tickingType.src)),V.current.chengeVolume(null===I||void 0===I?void 0:I.alarmVolume),V.current.changeFile(null===I||void 0===I?void 0:I.alarmType.src),V.current.changeLoop(null===I||void 0===I?void 0:I.alarmRepet),"none"!==I.clickType.name&&(B.current.chengeVolume(I.clickVolume),B.current.changeFile(I.clickType.src))}),[I]),(0,i.useEffect)((function(){(S===l.aI&&I.autoPomodors||S!==l.aI&&I.autoBreaks)&&0!==C&&N&&(setTimeout((function(){V.current.handleStop(),"none"!==I.tickingType.name&&R.current.handlePlay(),h.postMessage({started:!N,count:I.time[S]}),O({type:l.BG,data:0}),console.log(D,0,"autoBreaks autoPomodors")}),5e3),console.log(S))}),[S,I.autoBreaks,I.autoPomodors]),(0,i.useEffect)((function(){N?(document.body.onbeforeunload=function(){return function(){return"Hello, world!"}},I.focusMode&&(document.body.style.backgroundColor="rgb(30 30 30)",document.body.style.overflow="hidden")):(document.body.onbeforeunload=null,I.focusMode&&(document.body.style.backgroundColor=j[S].color,document.body.style.overflow="auto"))}),[N]),h.onmessage=function(e){var o,n,t;"stop"!==e.data?(L(e.data),"Notification"in window&&"granted"===(null===(o=window)||void 0===o||null===(n=o.Notification)||void 0===n?void 0:n.permission)&&0!==D&&("every"===I.notificationType?D%(60*I.notificationInterval)===0&&D!==E&&(0,r.hi)("".concat(D/60," minutes left!")):D-60*I.notificationInterval===0&&D!==E&&(0,r.hi)("".concat(D/60," minutes left!")))):(console.log(e.data,D,0,"worker stop"),"none"!==I.tickingType.name&&R.current.handleStop(),V.current.handlePlay(),(S!==l.aI&&!I.autoPomodors||S===l.aI&&!I.autoBreaks)&&O({type:l.pt,data:0}),I.alarmRepet>0&&(V.current.changeLoop(!0),setTimeout((function(){V.current.handleStop()}),1e3*I.alarmRepet),console.log("alarm repet")),O((0,l.P8)(S,P,k,b)),"Notification"in window&&"granted"===(null===(t=window)||void 0===t?void 0:t.Notification.permission)&&(S===l.aI?(0,r.hi)("It's time to take a break"):(0,r.hi)("It's time to focus!")))},(0,i.useEffect)((function(){window.onkeydown=function(e){var o=document.activeElement.tagName.toLowerCase();["input","textarea"].includes(o)||("space"===e.code.toLowerCase()&&H(),"arrowright"!==e.code.toLowerCase()||N||U(),"keyc"!==e.code.toLowerCase()||N||Z())}}));var H=(0,i.useCallback)((function(){console.log("toggle start"),"none"!==I.clickType.name&&B.current.handlePlay(),V.current.handleStop(),N?(h.postMessage("stop"),"none"!==I.tickingType.name&&R.current.handleStop(),O({type:l.pt,data:I.time[S]-D})):("none"!==I.tickingType.name&&R.current.handlePlay(),N||h.postMessage({started:!N,count:D}),O({type:l.BG,data:0}))}),[N,D]),Z=function(){L(E),"none"!==I.clickType.name&&B.current.handlePlay(),localStorage.setItem("restOfTime",0)},U=function(){O({type:l.vg})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"clock-container",style:{background:j[S].timerBorder},children:[!N&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g,{}),(0,m.jsx)(v,{setOpenSetting:x}),(0,m.jsx)(p,{})]}),(0,m.jsx)("div",{className:"clock",children:(0,m.jsx)(i.Suspense,{fallback:(0,m.jsx)(u.Z,{color:j[S].color,backgroud:"transparent",size:"200",strokeWidth:"2.5"}),children:"digital"===I.format?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(y,{handleReset:Z,toggleStart:H,setTime:L,time:D,handleSkip:U})}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(w,{handleReset:Z,toggleStart:H,setTime:L,time:D,handleSkip:U})})})})]})})}},7710:function(e,o,n){n.d(o,{hi:function(){return a},mr:function(){return t},qT:function(){return i}});var t=function(e){var o=e%60,n=Math.floor(e/60);return"".concat(n>=10?n:"0"+n,":").concat(o>=10?o:"0"+o)},i=function(e){var o=new Date(Date.now()),n=new Date(e),t={year:"numeric",month:"short",day:"numeric"};return o.getFullYear()===n.getFullYear()?o.getMonth()===n.getMonth()?o.getDate()===n.getDate()?o.getHours()===n.getHours()?o.getMinutes()===n.getMinutes()?"Updated now":"Updated ".concat(o.getMinutes()-n.getMinutes()," Min ago"):"Updated ".concat(o.getHours()-n.getHours()," Hours ago"):"Updated ".concat(o.getDate()-n.getDate()," Days ago"):"Updated ".concat(n.toLocaleDateString("en",t).split(",")[0]," ago"):"Updated ".concat(n.toLocaleDateString("en",t)," ago")},a=function(e){var o;void 0!==typeof(null===(o=window)||void 0===o?void 0:o.Notification)&&new window.Notification(e,{icon:"favicon.ico",tag:"mohamed ali",requireInteraction:!0,renotify:!0})}}}]);
//# sourceMappingURL=845.3e0102b5.chunk.js.map